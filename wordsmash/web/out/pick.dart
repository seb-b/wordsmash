// Auto-generated from pick.html.
// DO NOT EDIT.

library pick_html;

import 'dart:html' as autogenerated;
import 'dart:svg' as autogenerated_svg;
import 'package:web_ui/web_ui.dart' as autogenerated;
import 'package:web_ui/observe/observable.dart' as __observe;
import 'dart:html';
import 'package:web_ui/web_ui.dart';
import 'dart:json';
import 'package:js/js.dart' as js;
import 'dart:math';


// Original code


final __changes = new __observe.Observable();

String __$sentence;
String get sentence {
  if (__observe.observeReads) {
    __observe.notifyRead(__changes, __observe.ChangeRecord.FIELD, 'sentence');
  }
  return __$sentence;
}
set sentence(String value) {
  if (__observe.hasObservers(__changes)) {
    __observe.notifyChange(__changes, __observe.ChangeRecord.FIELD, 'sentence',
        __$sentence, value);
  }
  __$sentence = value;
}

//TODO: these can be local
List<OptionElement> nouns = new List();
List<OptionElement> verbs = new List();
List<OptionElement> adjectives = new List();

String __$noun;
String get noun {
  if (__observe.observeReads) {
    __observe.notifyRead(__changes, __observe.ChangeRecord.FIELD, 'noun');
  }
  return __$noun;
}
set noun(String value) {
  if (__observe.hasObservers(__changes)) {
    __observe.notifyChange(__changes, __observe.ChangeRecord.FIELD, 'noun',
        __$noun, value);
  }
  __$noun = value;
}
String __$verb;
String get verb {
  if (__observe.observeReads) {
    __observe.notifyRead(__changes, __observe.ChangeRecord.FIELD, 'verb');
  }
  return __$verb;
}
set verb(String value) {
  if (__observe.hasObservers(__changes)) {
    __observe.notifyChange(__changes, __observe.ChangeRecord.FIELD, 'verb',
        __$verb, value);
  }
  __$verb = value;
}
String __$adj;
String get adj {
  if (__observe.observeReads) {
    __observe.notifyRead(__changes, __observe.ChangeRecord.FIELD, 'adj');
  }
  return __$adj;
}
set adj(String value) {
  if (__observe.hasObservers(__changes)) {
    __observe.notifyChange(__changes, __observe.ChangeRecord.FIELD, 'adj',
        __$adj, value);
  }
  __$adj = value;
}

List pages = new List();


void main() {
  getNouns();
  getVerbs();
  getAdjectives();
}

void getNouns()
{
  String url = "http://api.wordnik.com/v4/words.json/randomWords?hasDictionaryDef=true&includePartOfSpeech=noun&minCorpusCount=0&maxCorpusCount=-1&minDictionaryCount=1&maxDictionaryCount=-1&minLength=3&maxLength=-1&limit=10&api_key=9426b5f9c67e03853f5410a188e06bc4136900201e3fd92eb";
  var request = HttpRequest.getString(url).then(nounResponse);

}

void nounResponse(String response)
{
  List data = parse(response);
  for(Map word in data)
  {
    nouns.add(new OptionElement(word["word"], word["word"], false, true));
  }
  query("#noun-select").children.addAll(nouns);
}

void getVerbs()
{
  String url = "http://api.wordnik.com/v4/words.json/randomWords?hasDictionaryDef=true&includePartOfSpeech=verb&minCorpusCount=0&maxCorpusCount=-1&minDictionaryCount=1&maxDictionaryCount=-1&minLength=3&maxLength=-1&limit=10&api_key=9426b5f9c67e03853f5410a188e06bc4136900201e3fd92eb";
  var request = HttpRequest.getString(url).then(verbResponse);
}

void verbResponse(String response)
{
  List data = parse(response);
  for(Map word in data)
  {
    verbs.add(new OptionElement(word["word"], word["word"], false, true));
  }
  query("#verb-select").children.addAll(verbs);
}

void getAdjectives()
{
  String url = "http://api.wordnik.com/v4/words.json/randomWords?hasDictionaryDef=true&includePartOfSpeech=adjective&minCorpusCount=0&maxCorpusCount=-1&minDictionaryCount=1&maxDictionaryCount=-1&minLength=3&maxLength=-1&limit=10&api_key=9426b5f9c67e03853f5410a188e06bc4136900201e3fd92eb";
  var request = HttpRequest.getString(url).then(adjectiveResponse);
}

void adjectiveResponse(String response)
{
  List data = parse(response);
  for(Map word in data)
  {
    adjectives.add(new OptionElement(word["word"], word["word"], false, true));
  }
  query("#adj-select").children.addAll(adjectives);
  updateAllDefs();
}

void updateAllDefs()
{
  if(noun == null)
  {
    noun = query("#noun-select").value;
  }
  if(verb == null)
  {
    verb = query("#verb-select").value;
  }
  if(adj == null)
  {
    adj = query("#adj-select").value;
  }
  getNounDef(noun);
  getVerbDef(verb);
  getAdjDef(adj);
}

void wordChanged(Event e)
{
  String whoChanged = e.target.id;
  String value = query("#" + whoChanged).value;
  if(whoChanged.indexOf("noun") != -1)
  {
    getNounDef(value);
  }
  if(whoChanged.indexOf("verb") != -1)
  {
    getVerbDef(value);
  }
  if(whoChanged.indexOf("adj") != -1)
  {
    getAdjDef(value);
  }
}

void getNounDef(String word)
{
  String url = "http://api.wordnik.com/v4/word.json/"+word+"/definitions?limit=1&includeRelated=true&partOfSpeech=noun&useCanonical=false&includeTags=false&api_key=9426b5f9c67e03853f5410a188e06bc4136900201e3fd92eb";
  var request = HttpRequest.getString(url).then(nounDef);
}

void nounDef(String response)
{
  Map fullDef = parse(response)[0];
  query("#noun-def").text = fullDef["text"];
}

void getVerbDef(String word)
{
  String url = "http://api.wordnik.com/v4/word.json/"+word+"/definitions?limit=1&includeRelated=true&partOfSpeech=verb&useCanonical=false&includeTags=false&api_key=9426b5f9c67e03853f5410a188e06bc4136900201e3fd92eb";
  var request = HttpRequest.getString(url).then(verbDef);
}

void verbDef(String response)
{
  Map fullDef = parse(response)[0];
  query("#verb-def").text = fullDef["text"];
}

void getAdjDef(String word)
{
  String url = "http://api.wordnik.com/v4/word.json/"+word+"/definitions?limit=1&includeRelated=true&partOfSpeech=adjective&useCanonical=false&includeTags=false&api_key=9426b5f9c67e03853f5410a188e06bc4136900201e3fd92eb";
  var request = HttpRequest.getString(url).then(adjDef);
}

void adjDef(String response)
{
  Map fullDef = parse(response)[0];
  query("#adj-def").text = fullDef["text"];
}

void getGoogleImage()
{ 
  query("#google-pic").src = "resources/images/loading.gif";
  js.context.handler = new js.Callback.once(display);  
  
  var script = new ScriptElement();
  var sentence = query("#sentence").text;
  script.src = "http://ajax.googleapis.com/ajax/services/search/images?v=1.0&rsz=8&q="+sentence+"&callback=handler";
  document.body.nodes.add(script);
}

void display(var data)
{
  var response = data.responseData;
  var results = response.results;
  if(results.length == 0)
  {
    return;
  }
  var rng = new Random();
  int index = rng.nextInt(results.length);
  var firstResult = results[index];
  query("#google-pic").src = firstResult.unescapedUrl;
}


// Additional generated code
void init_autogenerated() {
  var __root = autogenerated.document.body;
  var __e3, __e4, __e5, __e6, __e7;
  var __t = new autogenerated.Template(__root);
  __e3 = __root.nodes[1].nodes[1].nodes[3];
  var __binding0 = __t.contentBind(() => adj, false);
  var __binding1 = __t.contentBind(() => noun, false);
  var __binding2 = __t.contentBind(() => verb, false);
  __e3.nodes.addAll([new autogenerated.Text('The '),
      __binding0,
      new autogenerated.Text(' '),
      __binding1,
      new autogenerated.Text(' likes to (be) '),
      __binding2]);
  __e4 = __root.nodes[1].nodes[5];
  __t.listen(__e4.onChange, ($event) { adj = __e4.value; });
  __t.listen(__e4.onChange, ($event) { wordChanged($event); });
  __t.oneWayBind(() => adj, (e) { if (__e4.value != e) __e4.value = e; }, false, false);
  __e5 = __root.nodes[1].nodes[12];
  __t.listen(__e5.onChange, ($event) { noun = __e5.value; });
  __t.listen(__e5.onChange, ($event) { wordChanged($event); });
  __t.oneWayBind(() => noun, (e) { if (__e5.value != e) __e5.value = e; }, false, false);
  __e6 = __root.nodes[1].nodes[19];
  __t.listen(__e6.onChange, ($event) { verb = __e6.value; });
  __t.listen(__e6.onChange, ($event) { wordChanged($event); });
  __t.oneWayBind(() => verb, (e) { if (__e6.value != e) __e6.value = e; }, false, false);
  __e7 = __root.nodes[1].nodes[26];
  __t.listen(__e7.onClick, ($event) { getGoogleImage(); });
  __t.create();
  __t.insert();
}

//@ sourceMappingURL=pick.dart.map